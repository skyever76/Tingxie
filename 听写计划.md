# 听写小程序完整开发计划

## 项目概述
**目标**：开发一个基于微信小程序的多级目录英语/中文听写工具，支持词库管理、语音朗读和多种听写设置
**技术栈**：微信小程序 + 微信云开发
**开发周期**：预计10-14天
**难度等级**：新手友好

## 前期准备工作（第0天）

### 1. 环境搭建
- [ ] 注册微信小程序账号（个人/企业）
- [ ] 下载安装微信开发者工具
- [ ] 申请AppID和AppSecret
- [ ] 开通云开发服务

### 2. 工具准备
- [ ] 安装Cursor编辑器
- [ ] 准备测试用的中英文词库（建议先准备各50-100个常用单词/课文）

## 第一阶段：基础框架搭建（第1-3天）

### Day 1: 项目初始化
**目标**：创建项目并配置云开发环境

#### 任务清单：
- [ ] 使用微信开发者工具创建新项目
- [ ] 开通云开发，记录环境ID
- [ ] 配置项目基本信息（app.json, app.js）
- [ ] 创建基本页面结构
- [ ] 配置tabBar为"中文词库/英文词库/设置"

#### 关键代码结构：
```
project/
├── pages/
│   ├── chinese/         # 中文词库tab
│   ├── english/         # 英文词库tab
│   ├── settings/        # 设置tab
│   ├── dictation/       # 听写页面
│   └── ...              # 其他二级/三级目录页面
├── cloudfunctions/      # 云函数
└── app.js              # 小程序入口
```

#### Cursor提示词模板：
```
请帮我创建一个微信小程序的app.js文件，需要包含：
1. 云开发初始化，环境ID为 'YOUR_ENV_ID'
2. 全局数据存储用户OpenID
3. 小程序生命周期函数
```

### Day 2: 用户登录系统
**目标**：实现微信授权登录

#### 任务清单：
- [ ] 创建登录页面UI
- [ ] 实现微信登录逻辑
- [ ] 创建login云函数
- [ ] 存储用户OpenID

#### 云函数 - login：
```javascript
// 获取用户OpenID和AppID
const cloud = require('wx-server-sdk')
cloud.init()

exports.main = async (event, context) => {
  const wxContext = cloud.getWXContext()
  return {
    openid: wxContext.OPENID,
    appid: wxContext.APPID,
  }
}
```

### Day 3: 页面导航和基础UI
**目标**：完善页面间导航和基础界面

#### 任务清单：
- [ ] 设计应用整体UI风格
- [ ] 实现页面间跳转逻辑
- [ ] 创建通用组件（按钮、卡片等）
- [ ] 添加loading和错误处理

## 第二阶段：多级目录与词库管理（第4-7天）

### Day 4: tabBar与多级目录页面
**目标**：实现tabBar和多级目录导航

#### 任务清单：
- [ ] 配置tabBar为"中文词库/英文词库/设置"
- [ ] 中文词库tab：显示"小学语文一年级上"到"五年级下"等一级目录
- [ ] 英文词库tab：显示"小学英语""中学英语""小托福""托福"等一级目录
- [ ] 点击一级目录进入二级页面，显示课文/单元列表（编号+标题）
- [ ] 点击课文/单元进入听写页面

### Day 5: 数据库设计与测试数据
**目标**：设计并创建多级目录和词库集合

#### 数据库集合设计：
- chinese_categories/english_categories：存储各级目录结构
- chinese_texts/english_lists：存储课文/单元详细内容

#### 任务清单：
- [ ] 在云开发控制台创建相关集合
- [ ] 设置数据库权限（仅创建者可读写）
- [ ] 创建测试数据

### Day 6: 词库管理功能
**目标**：实现词库的创建、导入、删除、修改

#### 任务清单：
- [ ] 设置tab的"词库管理"入口
- [ ] 创建词库管理页面，支持创建、导入、删除、修改词库
- [ ] 支持批量单词/课文输入（逗号、制表符、JSON等格式）
- [ ] 创建addWordList等云函数，实现词库数据的增删改查
- [ ] 表单验证和错误处理

#### 云函数 - addWordList：
```javascript
const cloud = require('wx-server-sdk')
cloud.init()
const db = cloud.database()

exports.main = async (event, context) => {
  const wxContext = cloud.getWXContext()
  const { name, description, words, category } = event
  
  try {
    const result = await db.collection('word_lists').add({
      data: {
        name,
        description,
        words,
        category,
        totalWords: words.length,
        createdAt: new Date(),
        updatedAt: new Date(),
        isPublic: false,
        _openid: wxContext.OPENID
      }
    })
    return { success: true, id: result._id }
  } catch (error) {
    return { success: false, error: error.message }
  }
}
```

#### 输入格式支持：
- 逗号分隔：`apple,苹果`
- 制表符分隔：`apple	苹果`
- JSON格式导入

## 第三阶段：听写核心与设置（第8-10天）

### Day 7: 听写页面与流程
**目标**：实现听写页面和流程

#### 任务清单：
- [ ] 设计听写页面UI布局
- [ ] 实现从目录/词库跳转到听写页面
- [ ] 支持编号+课文标题/单元标题的显示
- [ ] 实现听写状态管理、进度显示、播放控制

### Day 8: 听写设置功能
**目标**：实现听写设置项

#### 任务清单：
- [ ] 设置tab下添加"听写设置"入口
- [ ] 支持设置是否随机、是否显示拼音、是否自动下一个、播放速度、重复次数等
- [ ] 设置项保存到全局或本地storage

## 第四阶段：优化和完善（第11-14天）

### Day 9: 用户体验优化
**目标**：提升应用的易用性

#### 任务清单：
- [ ] 优化页面加载速度
- [ ] 添加操作反馈（振动、提示音）
- [ ] 实现错误重试机制
- [ ] 优化离线体验

#### 性能优化要点：
- 词库数据本地缓存
- 音频文件预加载
- 分页加载大词库
- 图片懒加载

### Day 10: 数据统计与社交功能（可选）
**目标**：添加学习进度跟踪和分享

#### 任务清单：
- [ ] 记录听写完成情况
- [ ] 创建学习统计页面
- [ ] 实现词库分享、导入、公开浏览等功能

## 技术实现要点

### 1. 多级目录与页面跳转
- 一级目录页面用静态数据或数据库渲染
- 二级页面显示课文/单元列表，点击进入听写
- 目录结构建议用集合或静态数组维护

### 2. 词库管理与听写设置
- 词库管理页面支持增删改查
- 听写设置页面用switch/slider/picker等控件

### 3. 其他最佳实践
- 错误处理、数据缓存、音频播放管理等同原计划

## 使用Cursor的最佳实践

### 1. 提示词模板库
**创建页面组件**：
```
请创建一个微信小程序页面 pages/[页面名]/[页面名].js，包含：
1. 页面数据定义
2. 生命周期函数
3. [具体功能]函数
4. 错误处理
请提供完整代码并添加详细注释
```

**创建云函数**：
```
请创建微信小程序云函数 [函数名]，功能包括：
1. 参数：[参数列表]
2. 数据库操作：[具体操作]
3. 返回：[返回格式]
4. 错误处理
请使用wx-server-sdk，提供完整的index.js代码
```

### 2. 调试技巧
- 分步骤实现功能，每个功能点单独测试
- 使用console.log记录关键数据
- 在云开发控制台查看云函数日志
- 利用微信开发者工具的调试功能

### 3. 学习建议
- 先理解整体架构，再关注具体实现
- 多查阅微信小程序官方文档
- 参考优秀的开源小程序项目
- 加入相关技术社群交流

## 项目成本估算

### 开发成本
- 微信小程序注册：300元（企业）/免费（个人）
- 云开发费用：免费额度通常够个人使用
- 第三方API费用：TTS服务通常有免费额度

### 时间投入
- 每天2-4小时编码时间
- 总计30-60小时开发时间
- 学习成本：需要掌握小程序开发基础

## 风险评估和应对

### 技术风险
1. **TTS服务稳定性**：准备备用方案
2. **云开发配额限制**：监控使用量
3. **审核不通过**：提前了解审核规则

### 解决方案
- 充分测试各种边界情况
- 准备详细的使用说明文档
- 建立用户反馈渠道

这个开发计划结合了Gemini建议的优点，并补充了更多实施细节和最佳实践，特别适合技术新手循序渐进地完成一个完整的小程序项目。